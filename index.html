<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
    <title>Color picker | Canvas pixel manipulation</title>

        <style>
            .color-cell {
                color: white;
            }
        </style>
  </head>
  <body>
    <img id="img" src="boccioni.png" style="display: none"></img>

    <table>
        <thead>
            <tr>
                <th>Source</th>
                <th width="150">Hovered color</th>
                <th width="150">Selected color</th>
            </tr>
        </thead>
        <tbody>
            <tr>
                <td>
                    <canvas id="canvas" width="300" height="277"></canvas>
                </td>
                <td align="center" class="color-cell" id="hovered-color"></td>
                <td align="center" class="color-cell" id="selected-color">
                    <tbody>
                        <tr>
                            <td id="1"></td>
                            <td id="2"></td>
                            <td id="3"></td>
                            <td id="4"></td>
                        </tr>
                        <tr>
                            <td id="5"></td>
                            <td id="6"></td>
                            <td id="7"></td>
                            <td id="8"></td>
                        </tr>
                        <tr>
                            <td id="9"></td>
                            <td id="10"></td>
                            <td id="11"></td>
                            <td id="12"></td>
                        </tr>
                    <tbody>
                </td>
            </tr>
        </tbody>
    <table>
    <script>
        var img = document.getElementById("img")
        var canvas = document.getElementById('canvas');
        var ctx = canvas.getContext('2d');
        var count = 1;
        img.onload = function() {
          ctx.drawImage(img, 0, 0, canvas.width, canvas.height);
          img.style.display = 'none';
        };
        var hoveredColor = document.getElementById('hovered-color');
        // var selectedColor = document.getElementById(count.toString());


        function pick(event, destination) {
          var x = event.layerX;
          var y = event.layerY;
          var pixel = ctx.getImageData(x, y, 1, 1);
          var data = pixel.data;

            const rgba = `rgba(${data[0]}, ${data[1]}, ${data[2]}, ${data[3] / 255})`;
            destination.style.background = rgba;
            destination.textContent = rgba;

            return rgba;
        }

        canvas.addEventListener('mousemove', function(event) {
            pick(event, hoveredColor);
        });
        canvas.addEventListener('click', function(event) {
            var selectedColor = document.getElementById(count.toString());
            pick(event, selectedColor);
            count++;
        });
    </script>
  </body>
</html>